#!/usr/bin/env python

# Authors:
#   Jason Gerard DeRose <jderose@novacut.com>
#
# dmedia: distributed media library
# Copyright (C) 2010 Jason Gerard DeRose <jderose@novacut.com>
#
# This file is part of `dmedia`.
#
# `dmedia` is free software: you can redistribute it and/or modify it under the
# terms of the GNU Affero General Public License as published by the Free
# Software Foundation, either version 3 of the License, or (at your option) any
# later version.
#
# `dmedia` is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
# A PARTICULAR PURPOSE.  See the GNU Affero General Public License for more
# details.
#
# You should have received a copy of the GNU Affero General Public License along
# with `dmedia`.  If not, see <http://www.gnu.org/licenses/>.

import sys
from dmedialib.metastore import MetaStore
from dmedialib import ui

store = MetaStore()
app = ui.create_app()
store.update(app)
print store.db['app']['_rev']

sys.exit()

from os import path
import gtk
import gobject
import webkit
from dmedialib.ui import WSGIApp

gobject.threads_init()

app = WSGIApp()
xhtml = app.render()


window = gtk.Window()
window.set_title('test')
window.set_default_size(640, 480)
window.connect('destroy', gtk.main_quit)

box = gtk.VBox()
window.add(box)

view = webkit.WebView()
settings = view.get_settings()
settings.set_property('enable-developer-extras', True)

view.load_string(xhtml, 'application/xhtml+xml', '', 'http://localhost:5984')
box.pack_start(view, True, True, 2)

inspector = view.get_web_inspector()
inspector.set_property('javascript-profiling-enabled', True)

# Enabling this causes a seg-fault, see lp:664896:
#   https://bugs.launchpad.net/ubuntu/+source/pywebkitgtk/+bug/664896
#inspector.set_property('timeline-profiling-enabled', True)

def on_inspect(*args):
    view2 = webkit.WebView()
    box.pack_start(view2, True, True, 2)
    return view2

inspector.connect('inspect-web-view', on_inspect)



window.show_all()

gtk.main()
